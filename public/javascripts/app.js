// Generated by CoffeeScript 1.11.1
(function() {
  angular.module('testApp', ['ui.router']).controller('testCtrl', [
    '$scope', '$state', '$location', function($scope, $state, $location) {
      $scope.message = 'Hello from Angular';
      $scope.activate_contact = function() {
        return $state.go('contacts');
      };
      return $scope.to_home = function() {
        return $location.path('/').replace();
      };
    }
  ]).config(function($stateProvider, $urlRouterProvider, $locationProvider) {
    var isAuth;
    $stateProvider.state('admin', {
      url: '/admin',
      templateUrl: 'templates/admin.html',
      controller: function($scope) {
        return $scope.messages = [
          {
            text: 'one'
          }, {
            text: 'two'
          }, {
            text: 'tree'
          }
        ];
      }
    }).state('users', {
      url: '/users',
      parent: 'admin',
      templateUrl: 'templates/admin-users.html',
      controller: function($scope) {
        return $scope.users = [
          {
            name: 'wezom'
          }
        ];
      }
    }).state('detail', {
      url: '/user/detail/:id',
      parent: 'admin',
      templateUrl: 'templates/admin-users-detail.html',
      controller: function($scope, $stateParams) {
        return $scope.user_id = $stateParams.id;
      }
    }).state('contacts', {
      templateUrl: 'templates/contacts.html',
      url: '/contact',
      controller: function($scope) {
        return $scope.contacts = ['Dima', 'Vova', 'Roma'];
      }
    }).state('messages', {
      template: '<h1>My Messages</h1>',
      url: '/message'
    }).state('message', {
      resolve: {
        messages: function($http) {
          return $http({
            method: 'GET',
            url: '/get_messages'
          }).then(function(res) {
            var messages;
            return messages = res.data;
          });
        }
      },
      data: {
        customData: 'one'
      },
      onEnter: isAuth,
      url: '/message/:name',
      templateUrl: function($stateParams) {
        return 'templates/messages-of-' + $stateParams.name + '.html';
      },
      controller: function($scope, $stateParams, $state, messages) {
        $scope.name = $stateParams.name;
        $scope.messages = messages;
        return console.log($state.current.data.customData);
      },
      views: {
        '': {
          template: '<h1> Messages </h1>'
        },
        myw: {
          controller: function() {
            return console.log('view 1');
          },
          template: '<h1> My template </h1>'
        }
      }
    });
    isAuth = function($http) {
      return $http({
        method: 'GET',
        url: '/is_auth'
      }).then(function(res) {
        return console.log(res.data);
      });
    };
    $locationProvider.html5Mode(false);
    return $locationProvider.hashPrefix('');
  }).run([
    '$rootScope', function($rootScope) {
      $rootScope.$on('$stateChangeStart', function(evt, next, current) {
        console.log("from " + current.url + " to " + next.url);
        return console.dir(current);
      });
      return $rootScope.$on('$stateChangeSuccess', function(evt, next, current) {
        console.log("from " + current.url + " to " + next.url);
        return console.dir(evt);
      });
    }
  ]);

}).call(this);
